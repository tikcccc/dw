# 核心功能清单

### 一：核心联动交互

| 功能点 | 详细描述 | 优先级 | 预期 |
| --- | --- | --- | --- |
| **列表与BIM视图联动** | - **列表 -> 视图**: 在左侧的 “RISC表单” 列表或右侧的 “文件列表” 中单击任一条目，系统会自动在中央BIM视图中高亮（蓝色）其所有关联的BIM构件。 
 - **列表 -> 列表**: 单击任一列表中的条目后，系统会自动筛选另一个列表，仅显示与当前选中条目相关联的项目。 | 1 | 7/7之前 |
| **BIM视图与列表联动** | - **视图 -> 列表**: 在BIM视图中手动单击一个或多个构件（使其进入蓝色高亮状态），两侧的 “RISC表单” 和 “文件列表” 会被自动筛选，仅显示与这些高亮构件相关联的条目。 | 1 | 7/7之前 |
| **HyD Code 高级筛选** | - 在左侧栏提供基于HyD Code的多层级（如Project, Contractor, System等）下拉菜单进行联动筛选。
- **默认效果**：选择筛选条件后，匹配的BIM构件将被自动高亮（黄色），同时两侧的RISC和文件列表会**默认**根据这些黄色构件进行筛选，显示相关联的条目。
- **优先规则**：如果用户在任何时候**手动点击**了构件（产生蓝色高亮），那么两侧列表的筛选逻辑会**立即改变**：列表将**忽略**黄色的筛选结果，转而**仅依赖**蓝色高亮的构件进行筛选和显示。蓝色高亮（手动选择）在列表筛选上拥有最高优先级。 | 1 | 7/7之前 |
| **高亮系统逻辑** | 系统采用“筛选高亮”与“手动高亮”的组合逻辑：
 - **筛选高亮 (黄色)**: 使用HyD Code筛选后，匹配的构件视图中会有筛选聚焦效果和黄色高亮效果（和demo一致），并且自动进入“筛选高亮集”。 
 - **手动高亮 (蓝色)**: 通过单击BIM构件或条目列表项，可将构件添加或移出“手动高亮集”。 
 -**最终高亮**: 视图中最终呈现的高亮效果为以上两个高亮集的**并集，**其中手动高亮（蓝色）的筛选文件/risc列表的优先级高于筛选高亮（黄色）。 | 1 | 7/7之前 |
| **筛选与点击交互** | 当用户已激活“HyD Code筛选”（视图中已有黄色高亮构件）后，再点击RISC或文件列表中的条目时，系统会根据构件范围触发两种不同交互：

情况一：关联构件在筛选范围内
若所点击条目关联的所有构件均在当前HyD Code筛选结果之内，系统会直接将这些构件以蓝色高光显示，覆盖原有的黄色高亮。

情况二：关联构件超出筛选范围
若所点击条目关联的构件有任何一个不在当前HyD Code筛选结果之内，系统会弹窗提示用户：“该条目关联的构件超出了您当前的筛选范围，是否要清除筛选并查看所有关联构件？”。此时用户可以选择：
  - 保留筛选：弹窗关闭，界面维持现状，操作中止。
  - 清除筛选：系统将自动清除所有HyD Code筛选条件，并以蓝色高光显示该条目关联的全部构件。 | 1 | 7/7之前 |

### 二：列表的筛选功能

| 功能点 | 详细描述 | 优先级 | 预期 |
| --- | --- | --- | --- |
| **RISC 表单筛选** | 提供丰富的筛选选项：
 - **模糊搜索**: 按 “请求编号(Request No)和inspection” 进行模糊搜索。 
 - **状态筛选**: 按 “Status (如Approved, Submitted)” 筛选。 
 - **日期范围筛选**: 按自定义的起止日期进行筛选。 
 - **绑定状态筛选**: 可勾选 “只显示与最新模型绑定的表单”。 | 2 | 7/7之前 |
| **文件列表筛选** | 提供丰富的筛选选项：
 - **模糊搜索**: 按 “文件名” 进行模糊搜索。 
 - **文件类型筛选**: 按 “文件类型” 筛选。 
 - **日期范围筛选**: 按自定义的上传起止日期进行筛选。 
 - **个人文件筛选**: 可勾选 “我上传的文件” 筛选出当前用户上传的所有文件。 
 - **绑定状态筛选**: 可勾选 “只显示与最新模型绑定的文件”。 | 2 | 7/7之前 |
| **全局清除功能** | - 当存在任何筛选条件（HyD Code、列表筛选）或高亮选择时，在左侧栏顶部会出现一个“清除全部”按钮。 
 - 点击该按钮可一键重置所有筛选条件、清除所有BIM视图高亮和列表选择状态，将界面恢复至初始状态。 | 3 | 7/7之前 |

### 三：文件添加与关联

| 功能点 | 详细描述 | 优先级 | 预期 |
| --- | --- | --- | --- |
| **文件添加与初始关联** | **核心规则**：此流程支持所有当前在BIM视图中被**高亮**的构件。只有是**蓝色高亮的**构件才可以于发起文件关联。
为了确保操作体验的连贯性，**文件管理页面**列出的文件列表，应与主仪表盘筛选出的文件列表**保持一致**。

**具体步骤如下**：
1.**高亮构件**：通过手动点击构件或者条目（产生蓝色高亮），使一个或多个目标构件处于高亮状态。

2. 再通过以下两种方式之一触发文件管理流程：

• **快捷按钮**:
按钮触发条件：当视图有蓝色高光时，触发可点击按钮的效果。 
点击右侧文件列表上方的“添加文件”按钮。
1. 点击右侧文件列表上方的“添加文件”按钮，系统会弹出确认对话框。
2. 确认后，进入一个全屏的“文件管理”页面，该页面已预先加载了所选构件的信息，同时用户跳转页面从ACC平台中选择新文件进行上传。
4. 确认操作后，系统将回到“文件管理”页面，让用户选择新上传的文件的文件类型，然后点击确认上传。

• **右键菜单**: 在任意一个**被蓝色高亮的构件**上右键单击，从弹出的菜单中选择“管理关联文件”。
1. 确认后，进入一个全屏的“文件管理”页面，该页面已预先加载了所选构件的信息。
2. 确认后，自动进入一个全屏的“文件管理”页面，同时用户跳转页面从集成的ACC平台中选择新文件进行上传。
4. 确认操作后，系统将回到“文件管理”页面，让用户选择新上传的文件的文件类型，然后点击确认上传。 | 1 | 7/7之前 |

### 四：文件管理（不用7/7之前完成）

| 功能点 | 详细描述 | 优先级 | 预期 |
| --- | --- | --- | --- |
| **文件编辑** | - 在文件管理页面，有权限的用户（管理员或文件上传者）可以点击“编辑”按钮。
- 在弹出的编辑窗口中，用户**可以修改文件的类型**（通过下拉菜单选择），但**无法修改文件名**（输入框为禁用状态）。
- 保存后，文件的“类型”会同步更新。 | 4 | 7/7之前或者之后 |
| **文件删除(解除绑定)** | 1. 删除操作本质
• 删除文件 = 删除文件与构件的绑定关系
• 不直接删除文件本身，而是解除绑定关系
2. 智能判断机制
• 自动检测删除绑定关系后，文件是否还有其他构件绑定
• 根据检测结果显示不同的确认提示
单个文件删除逻辑：
• 情况一：删除绑定后文件仍有其他构件绑定
    ◦ 提示：是否解除当前文件和已选择构件的绑定关系？
    ◦ 图标：蓝色链接图标
    ◦ 操作：仅解除与高亮构件的绑定
• 情况二：删除绑定后文件无任何构件绑定
    ◦ 提示：因为解除这组绑定关系后，这个文件将无任何绑定的构件，所以将会
从文件列表里面移除，此操作不可以撤销，确定是否这样做？
    ◦ 图标：红色警告图标（AlertCircle）
    ◦ 操作：完全从文件列表中移除
批量文件删除逻辑：
• 情况一：所有文件删除绑定后都还有其他构件绑定
    ◦ 提示：是否解除当前批量文件和已选择构件的绑定关系？
    ◦ 图标：蓝色链接图标
• 情况二：部分文件删除绑定后将无任何构件绑定
提示：因为解除这组绑定关系后，这些文件（显示具体文件名）将无任何绑定的构件，所以将会从文件列表里面移除，此操作不可以撤销，确定是否这样做？   
    ◦ 提示：显示具体哪些文件将被移除
    ◦ 图标：红色警告图标 | 3 | 7/7之前或者之后 |